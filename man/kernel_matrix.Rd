% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/kernel_matrix.R
\name{kernel_matrix}
\alias{kernel_matrix}
\title{Compute Kernel Matrix Between Input Locations}
\usage{
kernel_matrix(
  X,
  Xprime = NULL,
  theta = 0.1,
  kernel = c("gaussian", "matern52", "matern32"),
  anisotropic = TRUE
)
}
\arguments{
\item{X}{A numeric matrix (or vector) of input locations with shape \eqn{n
\times d}.}

\item{Xprime}{An optional matrix of input locations (defaults to \code{X}).
Should have the same number of columns as \code{X}.}

\item{theta}{A positive numeric scalar or vector of length equal to the
number of columns in \code{X}. Specifies the lengthscale(s).}

\item{kernel}{A character string indicating the kernel type. One of
\code{"gaussian"}, \code{"matern32"}, or \code{"matern52"}.}

\item{anisotropic}{Logical. If \code{TRUE} (default), \code{theta} is treated
as a vector of per-dimension scales. If \code{FALSE}, \code{theta} is a
global scalar lengthscale.}
}
\value{
A numeric matrix of kernel values of size \eqn{n \times m}, where
\eqn{n = \mathrm{nrow}(X)} and \eqn{m = \mathrm{nrow}(Xprime)}. Each
element \eqn{K_{ij}} corresponds to the kernel similarity between input
\eqn{X_i} and \eqn{Xprime_j}.
}
\description{
Computes the kernel matrix between \code{X} and \code{Xprime}
using a specified kernel function and length-scale parameters \code{theta}.
Supports both isotropic and anisotropic length scales. Supported kernels
include Gaussian, Matern 5/2, and Matern 3/2 kernels.
}
\details{
The kernel functions are defined as follows:
\deqn{
k_{\text{Gaussian}}(\mathbf{x}, \mathbf{x}') = \exp\left(- \|\mathbf{d}\|^2\right)
}
\deqn{
k_{\text{Matern 5/2}}(\mathbf{x}, \mathbf{x}') = \left(1 + \sqrt{5} r + \frac{5}{3} r^2\right) \exp(-\sqrt{5} r)
}
\deqn{
k_{\text{Matern 3/2}}(\mathbf{x}, \mathbf{x}') = \left(1 + \sqrt{3} r \right) \exp(-\sqrt{3} r)
}
where \eqn{r = \| \mathbf{d} \| = \left\| \frac{\mathbf{x} -
\mathbf{x}'}{\boldsymbol{\theta}} \right\|} is the scaled Euclidean distance.

The function automatically broadcasts \code{theta} if it is scalar and
performs input dimension checks.
}
\examples{

# Basic usage with default Xprime = X
X <- matrix(runif(20), ncol = 2)
K1 <- kernel_matrix(X, theta = 0.2, kernel = "gaussian")

# Anisotropic lengthscales with Matern 5/2
K2 <- kernel_matrix(X, theta = c(0.1, 0.3), kernel = "matern52")

# Isotropic Matern 3/2
K3 <- kernel_matrix(X, theta = 1, kernel = "matern32", anisotropic = FALSE)

# Use Xprime different from X
Xprime <- matrix(runif(10), ncol = 2)
K4 <- kernel_matrix(X, Xprime, theta = 0.2, kernel = "gaussian")

}
\references{
Rasmussen, C. E., & Williams, C. K. I. (2006). Gaussian Processes
for Machine Learning. MIT Press.
}
\author{
Jiangyan Zhao, Kunhai Qing, Jin Xu
}
